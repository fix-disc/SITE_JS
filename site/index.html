<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>LIBRO QUEJAS</title>
        <link id="css" rel="stylesheet" href="../css/style.css">
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css">
        
        
        <script src="../js/behaviour.js"></script>
    </head>
    <body onload="muestra_usuario()">
        <div id="contenido" class="contenido">

            <!-- HEADER -->
            <div class="header1">
                <div class="div_logo" onmousedown="show_menu('menu1')" style="width: 260px;">
                    
                    <img id="logo1" src="../img/LibroBlancoSinFondo.png" width="95%" style="margin-top: 3px;max-width: 80px; float: left;">
                    <img id="logo2" src="../img/logo_innova_blanco.png" width="95%" style="margin-top: 3px;max-width: 90px; float: left;">
                </div>
                <div class="div_user" onmousedown="show_menu('menu2')">
                    <div class="ball_usuario">
                        <img class="img_usuario" src="../img/user.png" width="30">
                    </div>
                    <ul class="div_user_data">
                        <i style="font-size:0.8rem; font-style: normal;"><span id="nombre"></span><span id="apellidop"></span></i><br>
                        <div class="ball_activo">&nbsp;</div><i style="font-size:0.7rem; font-style: normal;">&nbsp;&nbsp;Activo Ahora</i>
                        <div class="arrow-down"><i class="fa fa-sort-down arrow-down" aria-hidden="true"></i></div>
                    </ul>
                </div>
                
                
            </div>
            <div class="shadow1"></div>

            <!-- MENNU 1 -->
            <div id="menu1" class="menu1"><br>
                <ul style="font-size: 10px;">
                    <div style="height: 2px;">&nbsp;</div>
                    <div class="menu-item" onclick="abre_pag('usuarios.html')"><i class="fa fa-user-circle-o"></i>&nbsp;&nbsp;Usuarios<i class="fa fa-sort-down arrow-down" aria-hidden="true"></i></div>
                    <div class="menu-item" onclick="display_zona('subm_1')">
                        <i class="fa fa-weixin"></i>&nbsp;&nbsp;Reclamos
                        <i class="fa fa-sort-down arrow-down" aria-hidden="true"></i>
                    </div>
                    <div id="subm_1" class="div_subm">
                        <div class="shadow2" style="height: 10px;"></div>
                        <div style="width: 100%; height: 3px;"></div>
                        <div class="sub-menu" onclick="abre_pag('reclamos.html')"><i class="fa fa-arrows" aria-hidden="true"></i>Todos</div>
                        <div class="sub-menu"><i class="fa fa-clock-o" aria-hidden="true"></i>Pendientes</div>
                        <div class="sub-menu"><i class="fa fa-window-restore" aria-hidden="true"></i>Abiertas</div>
                        <div class="sub-menu"><i class="fa fa-window-close-o" aria-hidden="true"></i>Cerradas</div>
                    </div>
                    <div class="menu-item" onclick="abre_pag('reportes.html')"><i class="fa fa-bar-chart"></i>&nbsp;&nbsp;Reportes<i class="fa fa-sort-down arrow-down" aria-hidden="true"></i></div>
                    
                </ul>
            </div>

            <!-- MENNU 2 -->
            <div id="menu2" class="menu2">
                <div class="line0"></div>
                <div class="line"></div>
                <ul style="font-size: 10px;">
                    <div style="height: 2px;">&nbsp;</div>
                    <div class="menu-item" onclick="open_1('modal1', 'block');get_config()"><i class="fa fa-cog"></i>&nbsp;&nbsp;Configuración</div>
                    <div id="modo" class="menu-item" onclick="switch_1()"><i class="fa fa-adjust"></i>&nbsp;&nbsp;Modo Claro</div>
                    <div class="menu-item" onclick="javascript:window.location.href='../login.html'"><i class="fa fa-pause-circle"></i>&nbsp;&nbsp;Pausar</div>
                    <div class="menu-item" onclick="javascript:window.location.href='../login.html'"><i class="fa fa-power-off"></i>&nbsp;&nbsp;Salir</div>
                </ul>
            </div>

            <!-- CONTENIDO -->
            <div id="contenedor" class="contenedor" onmousedown="hide_all()">

            </div>

            <!-- MODAL 1 -->
            <div id="modal1" class="modal1">
                <div style="height: 100%; display: contents;">

                    <div id="close" class="close" onclick="close_1('modal1')"><img src="../img/close_icon.png" width="20px" height="20px"></div>
                    <div class="title" style="width: 100%;">
                        <i class="fa fa-cog" style="font-size: 1.4rem;"><span>&nbsp;&nbsp;OBSERVACIONES</span></i>
                    </div>
                    <div class="line" style="position: relative; width: 100%; margin-top:5px;"></div>
                    <div class="line0" style="position: relative; width: 100%;"></div>
                    <div style="width: 100%; height: 10px;"></div>

                    
                    <div style="width: 100%; height: 20px; display: block;">

                        <table width="100%">
                            <tr>
                                <td>
                                    <div id="cfg_content" style="width: 100%; max-height: 260px; float:left; overflow: auto; overflow-y: scroll; padding-right: 20px;">
                                        <textarea id="observaciones" width="100%" rows="16" style="width: 100%; max-height: 260px; float:left; overflow: auto; overflow-y: scroll; padding-right: 20px; background-color: #68696b; color:#fff"></textarea>   
                                        <input type="hidden" id="sel_reclamo" value="">
                                    </div>
                                </td>
                            </tr>

                        </table>
                    </div>
                    <div id="mod_footer" class="mod_footer" style="position: absolute;">
                        <div class="line" style="position: relative; width: 100%;"></div>
                        <div class="line0" style="position: relative; width: 100%;margin-bottom: 15px;"></div>
                        <div class="bot_save" onclick="guarda_observaciones()">GUARDAR</div>
                        <div class="bot_cancel" onclick="close_1('modal1')">CANCELAR</div>
                    </div>

                </div>
            </div>

            <!-- MODAL 2 -->
            <div id="modal2" class="modal1">
                <div style="height: 100%; display: contents;">

                    <div id="close" class="close" onclick="close_1('modal2')"><img src="../img/close_icon.png" width="20px" height="20px"></div>
                    <div class="title" style="width: 100%;">
                        <i class="fa fa-cog" style="font-size: 1.4rem;"><span>&nbsp;&nbsp;OBSERVACIONES</span></i>
                    </div>
                    <div class="line" style="position: relative; width: 100%; margin-top:5px;"></div>
                    <div class="line0" style="position: relative; width: 100%;"></div>
                    <div style="width: 100%; height: 10px;"></div>

                    
                    <div style="width: 100%; height: 20px; display: block;">

                        <table width="100%">
                            <tr>
                                <td>
                                    <div id="cfg_content" style="width: 100%; max-height: 260px; float:left; overflow: auto; overflow-y: scroll; padding-right: 20px;">
                                        <textarea id="observaciones" width="100%" rows="16" style="width: 100%; max-height: 260px; float:left; overflow: auto; overflow-y: scroll; padding-right: 20px; background-color: #68696b; color:#fff"></textarea>   
                                        <input type="hidden" id="sel_reclamo" value="">
                                    </div>
                                </td>
                            </tr>

                        </table>
                    </div>
                    <div id="mod_footer" class="mod_footer" style="position: absolute;">
                        <div class="line" style="position: relative; width: 100%;"></div>
                        <div class="line0" style="position: relative; width: 100%;margin-bottom: 15px;"></div>
                        <div class="bot_mod" onclick="modifica_observaciones()">MODIFICAR</div>
                        <div class="bot_cancel" onclick="close_1('modal2')">CANCELAR</div>
                    </div>

                </div>
            </div>


        </div>

        <!-- MODAL PHONE -->
        <div id="modal2" class="modal2" style="display: none;">
        </div>
        
    </div>


    </body>
</html>
<script src="../js/api.js"></script>
<script>

async function muestra_usuario(){
    document.getElementById("nombre").innerHTML = sessionStorage.getItem("nombre");
    document.getElementById("apellidop").innerHTML = sessionStorage.getItem("apellidop")

}

async function guarda_observaciones(){
    var obs = parent.document.getElementById("observaciones").value;
    var id = parent.document.getElementById("sel_reclamo").value;
    console.log("OBSERVACIONES: " + obs);
    // Aquí puedes agregar la lógica para enviar las observaciones al servidor

    await post_observaciones(id, obs).then(
        function(res){
            console.log("RESPONSE: " + JSON.stringify(res));
            if(res.message == 'Reclamo modificado'){
                abre_pag('reclamos.html');
                alert("Observaciones guardadas correctamente");
                parent.document.getElementById("modal1").style.display = "none";
            }else{
                alert("Error al guardar observaciones");
            }
            
        }
    );
}

async function modifica_observaciones(){
    var obs = parent.document.getElementById("observaciones").value;
    var id = parent.document.getElementById("sel_reclamo").value;
    console.log("OBSERVACIONES: " + obs);
    // Aquí puedes agregar la lógica para enviar las observaciones al servidor

    await mod_observaciones(id, obs).then(
        function(res){
            console.log("RESPONSE: " + JSON.stringify(res));
            if(res.message == 'Reclamo modificado'){
                abre_pag('reclamos.html');
                alert("Observaciones guardadas correctamente");
                parent.document.getElementById("modal1").style.display = "none";
            }else{
                alert("Error al guardar observaciones");
            }
            
        }
    );
}



</script>